<header>

# Using GitHub Copilot with C#

Welcome to a hands-on, multi-module course that transforms GitHub Copilot from a simple autocomplete tool into your proactive AI pair programmer. Whether you‚Äôre new to AI-assisted coding or looking to deepen your expertise, in this module you will learn how to leverage Copilot's features and enhance your efficiency when coding in C#. You will gain a clear understanding of Copilot's core capabilities and how they fit into modern C# workflows. This is a hands-on experience with getting to understand inline suggestions, natural-language prompting and context-aware code suggestions. 

Prepare to tackle a practical, hands-on project! You‚Äôll work on modifying a C# repository to create an API endpoint using GitHub Copilot. This exercise will provide valuable experience in building a C# web application that serves an HTTP API and generates pseudo-random weather forecast data.

</header>


- **Who this is for**: Developers, DevOps Engineers, Software Development Managers, Testers.
- **What you'll learn**: How to use GitHub Copilot to for code completion, inline suggestions and next edit suggestions, as well as adding comments to your work.
- **What you'll build**: C# files that will have code generated by Copilot AI for code and comment suggestions.
- **Prerequisites**: GitHub Copilot is available to use for free, sign up for [GitHub Copilot](https://gh.io/copilot).
- **Timing**: This course can be completed in under an hour.

By the end of this module, you'll acquire the skills to be able to:

- Engage with Copilot in the IDE using inline suggestions and next-edit completions. 
- Craft prompts to generate suggestions from GitHub Copilot using code completion and chat.
- Apply GitHub Copilot to improve your projects.

## Prerequisite reading:
- [Introduction to prompt engineering with GitHub Copilot](https://learn.microsoft.com/training/modules/introduction-prompt-engineering-with-github-copilot?WT.mc_id=academic-113596-abartolo)

- [What is the GitHub Copilot extension for Visual Studio?](https://learn.microsoft.com/visualstudio/ide/visual-studio-github-copilot-extension?view=vs-2022&WT.mc_id=academic-113596-abartolo)

## Requirements

1. Enable your [GitHub Copilot service](https://github.com/github-copilot/signup)

1. Get familiar with [this repository with Codespaces](https://github.com/github/dotnet-codespaces)

## üí™üèΩ Exercise

**Right click the following Codespaces button to open your Codespace in a new tab**
 
[![Open in GitHub Codespaces](https://github.com/codespaces/badge.svg)](https://codespaces.new/github/dotnet-codespaces)

The "**GitHub Codespaces ‚ô•Ô∏è .NET 8**" repository builds a Weather API using Minimal APIs, opens Swagger so you can call and test the API, and displays the data in a web application using Blazor with .NET 8.

We will review the steps to update the Weather BackEnd App by adding a new endpoint that requests a specific location and returns the weather forecast for that location.


### üóíÔ∏è Section 1: Exploring Your Project 

üéØ**Learning Goals**
- Use inline code completion to scaffold new classes and methods
- Trigger and refine Copilot completions
- Use inline chat and slash commands

Once your Codespace launches, you'll have a fully functional development environment with the entire repository preloaded. This is the perfect time to explore GitHub Copilot Chat to help you better understand the codebase.

To get started:

1. Click the Copilot Chat icon in the top-right corner of the Codespace window:

<div align="left">
<img src="./images/001-chat.jpg" alt="Open GitHub Copilot Chat" width="500" height="300">
</div>

2. Instead of manually exploring the BackEnd and Front folders, try asking Copilot for an overview. In the chat pane, type '/' to view available slash commands ‚Äî these offer quick, structured ways to interact with Copilot.

   Type `/help` to see all commands, or check out the [GitHub Copilot Chat cheat sheet](https://docs.github.com/copilot/reference/github-copilot-chat-cheat-sheet#slash-commands) for a list of available slash commands.

   For example, you can use:
   - `/doc` to add a documentation comment
   - `/explain` to explain the code
   - `/fix` to propose a fix for the problems in the selected code
   - `/generate` to generate code to answer your question

3. In lieu of using natural language, type `/explain` into the chat pane. The output from GitHub Copilot will go into details of how the project is structured, including further information of the Frontend and Backend details.

<div align="left">
<img src="./images/002explainoutput.gif" alt="Output of /Explain" width="500" height="300">
</div>

4. As a visual learner, you can ask GitHub Copilot to 'create a diagram of the workflow of the application'. This could be saved into a README for further documentation.

<div align="left">
<img src="./images/movingdiagram.gif" alt="Output of application diagram" width="500" height="300">
</div>

In the above exercises we achieved the following: 
- ‚úÖ Used slash commands to explain new code
- ‚úÖ Created a diagram to visualize and understand the application flow 

### üóíÔ∏è Section 2: Code Completion

1. Ask GitHub Copilot in the chat pane to "run and debug" the backend project (you can also do this from the 'run and debug' panel in the editor). Start Debugging the selected project.

<div align="left">
<img src="./images/003RunBackEndProject.jpg" alt="Run and Debug in the Panel">
</div>

2. The BackEnd project for our Weather API will now be running in port 8080. If you used Copilot to Run and Debug, it will output the URL for you in the chat pane. Simply click the text and it will open a new tab with the published URL. Ensure that `/weatherforcast` is in the published URL. 

<div align="left">
<img src="./images/004rundebugURL.jpg" alt="Run and Debug Output"
</div>

If the URL is not loading properly, check the format and use the below format for the final URL:

```bash
https://< your url>.app.github.dev/weatherforecast
```

**NOTE:** If you chose to run and debug the application from the run and debug panel, you will see the URL for the website in the _Ports_ tab in the editor:

<div align="left">
<img src="./images/005ports.jpg" alt="port view in the editor" width="500" height="300">
</div>

3. In this next step we want to refactor some code and generate a new record for our Weather API. The goal is to add a new record that includes the name of the city. From the file pane, navigate to the following path `SampleApp\BackEnd\Program.cs` and open `Program.cs`. Navigate to the end of the file and type in (or copy):

```csharp
// create a new internal record named WeatherForecastByCity that request the following parameters: City, Date, TemperatureC, Summary
```

TODO: show output

4. We can create a new C# class by creating a new file under the 'BackEnd' folder: '/BackEnd/customer.cs'. Press `CTRL + I` to open the inline chat and type in: 
   
```csharp
// Create a class for a Customer with Id, Name, and Email, and a method to validate email format
```

5. Accept the suggestion and using the inline prompt window ask: 

```csharp
/improve IsValidEmail method using Regex
```

6. You can further highlight the method and ask inline (or select `CTRL + Shift + I`) to open chat and ask Copilot 'Explain what IsValidEmail() does'

7. While Inline suggestions are great at autocompleting a section of code, we often need help with multiple edits. Copilot next edit suggestions will predict the location of the next edit and what that edit should be. In this task we will implement a simple endpoint for retrieving and creating customers.
TODO: More explanation
<div align="left">
<img src="./images/NextEdit.gif" alt="Output of /Explain" width="500" height="300">
</div>

In the above exercises we achieved the following: 
- ‚úÖ Generated suggestions from code comments
- ‚úÖ Used inline chat to generate new code, query code and accept coding suggestions
- ‚úÖ Trigger and refine Copilot suggestions


### üìÑSection 3: GitHub Copilot Agent Mode

üéØ**Learning Goals**
- Observe autonomous coding and PR generation
- Assign issues to the Copilot coding agent


[GitHub Copilot Agent Mode](https://github.blog/ai-and-ml/github-copilot/agent-mode-101-all-about-github-copilots-powerful-mode/) is an autonomous AI coding assistant that acts as a synchronous collaborator in real-time. It can perform coding tasks that require multiple steps all while using your natural language prompts. When working in Agent Mode, Copilot can problem solve alongside you, understanding your intent, and when the built solution needs some tweaking, it can iterate until it gets it right. In this section we're going to use Agent Mode to make a multitude of changes to our backend service to provide several improvement to our code. 

1. Open GitHub Copilot Chat. Notice in the text box you can 'add context', which allows you to attach files, folders and other items to the context of Copilot so that it can better understand your codebase. Agent mode should be selected by default. This is also the capability to choose your model as well. Also note, the open tab 'program.cs' is being referenced for context. 

2. Give Agent mode a detailed prompt. For this example we are going to ask Copilot to make several improvements to our project.

```
1. Add an endpoint for the Customer class in the project.
2. Configure CORS to allow the frontend to communicate with the backend
3. Add dependency injection for any services needed
4. Improve the organization by creating controller classes instead of inline route handlers
5. Write documentation for every change
6. Write tests using xUnit, verify error handling works correctly. 
```

Agent mode performed and outputted the following summary of changes:

```
**Customer Endpoint Implementation**
- Created a RESTful API for Customer with proper CRUD operations
- Added appropriate status codes and validation
  
**CORS Configuration**
- Properly configured CORS to allow the frontend to communicate with the backend
- Set up to allow any origin, method, and header for development purposes
  
**Dependency Injection**
- Added service interfaces and implementations for the Customer operations
- Configured DI in Program.cs to make the application more testable and maintainable
  
**Code Organization**
- Created a proper structure with Models, Controllers, and Services folders
- Moved inline route handlers to dedicated controller classes
- Applied consistent naming conventions

**Unit Tests**
- Added comprehensive tests for controllers and services
- Implemented tests for both success and error scenarios
- Verified validation logic works properly
  
**Documentation**
- Created detailed documentation for all APIs, models, and services
- Included response types and error handling details
```

Agent Mode confirmed that all tests are passing and that the application follows modern ASP.NET best practices with a focus on separation of concerns and test coverage. 

3. Finally, verify that the changes and new endpoint is working by starting the BackEnd project from the 'Run and Debug' panel. Once the project is running, test the original URL using your Codespace URL and original endpoint:

```bash
https://< your code space url >.app.github.dev/WeatherForecast
```

üöÄCongratulations! Now you understand the power behind Agent Mode and the many tasks that it can help with. Scroll down to the next section that will show you how to add context and customization to Copilot. 

Agent Mode was able to perform C# specific tasks:
- ‚úÖ Moving from inline route handlers to controller-based architecture
- ‚úÖ Adding proper model validation
- ‚úÖ Implementing comprehensive error handling
- ‚úÖ Setting up dependency injection for better testability
- ‚úÖ Creating an organized project structure

### üóíÔ∏è Section 4: Customization and Context 

TODO

### Useful Links and Further Learning
- [Use agent mode in VS Code](https://code.visualstudio.com/docs/copilot/chat/chat-agent-mode)
- [GitHub Copilot Chat Cheat Sheet](https://docs.github.com/copilot/reference/github-copilot-chat-cheat-sheet)

## Legal Notices

Microsoft and any contributors grant you a license to the Microsoft documentation and other content
in this repository under the [Creative Commons Attribution 4.0 International Public License](https://creativecommons.org/licenses/by/4.0/legalcode),
see the [LICENSE](LICENSE) file, and grant you a license to any code in the repository under the [MIT License](https://opensource.org/licenses/MIT), see the
[LICENSE-CODE](LICENSE-CODE) file.

Microsoft, Windows, Microsoft Azure and/or other Microsoft products and services referenced in the documentation
may be either trademarks or registered trademarks of Microsoft in the United States and/or other countries.
The licenses for this project do not grant you rights to use any Microsoft names, logos, or trademarks.
Microsoft's general trademark guidelines can be found at http://go.microsoft.com/fwlink/?LinkID=254653.

Privacy information can be found at https://privacy.microsoft.com/en-us/

Microsoft and any contributors reserve all other rights, whether under their respective copyrights, patents,
or trademarks, whether by implication, estoppel or otherwise.
